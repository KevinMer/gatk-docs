## Version highlights for GATK version 3.5

By Geraldine_VdAuwera

<p>The last GATK 3.x release of the year 2015 has arrived!</p>

<p>The major feature in GATK 3.5 is the eagerly awaited <strong>MuTect2 (beta version), which brings somatic SNP and Indel calling to GATK</strong>. This is just the beginning of GATK’s scope expansion into the somatic variant domain, so expect some exciting news about copy number variation in the next few weeks! Meanwhile, more on MuTect2 awesomeness below.</p>

<p>In addition, we’ve got all sorts of <strong>variant context annotation</strong>-related treats for you in the 3.5 goodie bag -- both new annotations and new capabilities for existing annotations, listed below.</p>

<p>In the <strong>variant manipulation space</strong>, we enhanced or fixed functionality in several tools including LeftAlignAndTrimVariants, FastaAlternateReferenceMaker and VariantEval modules. And in the variant calling/genotyping space, we’ve made some performance improvements across the board to HaplotypeCaller and GenotypeGVCFs (mostly by cutting out crud and making the code more efficient) including a few improvements specifically for haploids. Read the detailed release notes for more on these changes. Note that GenotypeGVCFs will now emit no-calls at sites where RGQ=0 in acknowledgment of the fact that those sites are essentially uncallable.</p>

<p>We’ve got good news for you if you’re the type who worries about disk space (whether by temperament or by necessity): we finally have <strong>CRAM support</strong> -- and some recommendations for keeping the output of BQSR down to reasonable file sizes, detailed below.</p>

<p>Finally, be sure to check out the detailed release notes for the usual variety show of minor features (including a new Queue job runner that enables local parallelism), bug fixes and deprecation notices (a few tools have been removed from the codebase, in the spirit of slimming down ahead of the holiday season).</p>

<hr></hr><h3>Introducing MuTect2 (beta): calling somatic SNPs and Indels natively in GATK</h3>

<p>MuTect2 is the next-generation somatic SNP and indel caller that combines the DREAM challenge-winning somatic genotyping engine of the original MuTect with the assembly-based machinery of HaplotypeCaller.</p>

<p>The original MuTect (<a rel="nofollow" href="http://www.nature.com/nbt/journal/v31/n3/full/nbt.2514.html">Cibulskis et al., 2013</a>) was built on top of the GATK engine by the Cancer Genome Analysis group at the Broad Institute, and was distributed as a separate package. By all accounts it did a great job calling somatic SNPs, and was part of the winning entries for multiple DREAM challenges (including some submitted by groups outside the Broad). However it was not able to call indels; and the less said about the indel caller that accompanied it (first named SomaticIndelDetector then Indelocator) the better.</p>

<p>This new incarnation of MuTect leverages much of the HaplotypeCaller’s internal machinery (including the all-important graph assembly bit) to call both SNPs and indels together. Yet it retains key parts of the original MuTect’s internal genotyping engine that allow it to model somatic variation appropriately. This is a major differentiation point compared to HaplotypeCaller, which has expectations about ploidy and allele frequencies that make it unsuitable for calling somatic variants.</p>

<p>As a convenience add-on to MuTect2, we also integrated the cross-sample contamination estimation tool ContEst into GATK 3.5. Note that while the previous public version of this tool relied on genotyping chip data for its operation, this version of the tool has been upgraded to enable on-the-fly genotyping for the case where genotyping data is not available. Documentation of this feature will be provided in the near future. Both MuTect2 and ContEst are now featured in the <a rel="nofollow" href="https://www.broadinstitute.org/gatk/guide/tooldocs/">Tool Documentation</a> section of the Guide. Stay tuned for pipeline-level documentation on performing somatic variant discovery, to be added to the Best Practices docs in the near future.</p>

<p>Please note that this release of MuTect2 is a beta version intended for research purposes only and should not be applied in production/clinical work. MuTect2 has not yet undergone the same degree of scrutiny and validation as the original MuTect since it is so new. Early validation results suggest that MuTect2 has a tendency to generate more false positives as compared to the original MuTect; for example, it seems to overcall somatic mutations at low allele frequencies, so for now we recommend applying post-processing filters, e.g. by hard-filtering calls with low minor allele frequencies. Rest assured that data is being generated and the tools are being improved as we speak. We’re also looking forward to feedback from you, the user community, to help us make it better faster.</p>

<p>Finally, note also that MuTect2 is distributed under the same restricted license as the original MuTect; for-profit users are required to seek a license to use it (please email softwarelicensing@broadinstitute.org). To be clear, while MuTect2 is released as part of GATK, the commercial licensing has <strong>not</strong> been consolidated under a single license. Therefore, current holders of a GATK license will still need to contact our licensing office if they wish to use MuTect2.</p>

<hr></hr><h3>Annotate this: new and improved variant context annotations</h3>

<p>Whew that was a long wall of text on MuTect2, wasn’t it. Let’s talk about something else now. Annotations! Not <em>functional</em> annotations, mind you -- we’re not talking about <em>e.g.</em> predicting synonymous vs. non-synonymous mutations here. I mean <em>variant context</em> annotations, <em>i.e.</em> all those statistics calculated during the variant calling process which we mostly use to estimate how confident we are that the variants are real vs. artifacts (for filtering and related purposes).</p>

<p>So we have two new annotations, BaseCountsBySample (what it says on the can) and ExcessHet (for excess heterozygosity, i.e. the number of heterozygote calls made in excess of the Hardy-Weinberg expectations), as well as a set of new annotations that are allele-specific versions of existing annotations (with <code class="code codeInline" spellcheck="false">AS_</code> prefix standing for <strong>Allele-Specific</strong>) which you can browse <a rel="nofollow" href="https://www.broadinstitute.org/gatk/guide/tooldocs/index#VariantAnnotations">here</a>. Right now we’re simply experimenting with these allele-specific annotations to determine what would be the best way to make use of them to improve variant filtering. In the meantime, feel free to play around with them (via e.g. VariantsToTable) and let us know if you come up with any interesting observations. Crowdsourcing is all the rage, let’s see if it gets us anywhere on this one!</p>

<p>We also made some improvements to the StrandAlleleCountsBySample annotation, to how VQSR handles MQ, and to how VariantAnnotator makes use of external resources -- and we fixed that annoying bug where default annotations were getting dropped. All of which you can read about in the detailed release notes.</p>

<hr></hr><h3>These Three Awesome File Hacks Will Restore Your Faith In Humanity’s Ability To Free Up Some Disk Space</h3>

<p><strong>CRAM support!</strong> Long-awaited by many, lovingly implemented by Vadim Zalunin at EBI and colleagues at the Sanger Institute. We haven’t done extensive testing, and there are a few tickets for improvements that are planned at the htsjdk level -- but it works well enough that we’re comfortable releasing it under a <strong>beta</strong> designation. Meaning have fun with it, but do your own thorough testing before putting it into production or throwing out your old BAMs!</p>

<p><strong>Static binning of base quality scores.</strong> In a nutshell, binning (or quantizing) the base qualities in a BAM file means that instead of recording all possible quality values separately, we group them into <em>bins</em> represented by a single value (by default, 10, 20, 30 or 40). By doing this we end up having to record fewer separate numbers, which through the magic of BAM compression yields substantially smaller files. The idea is that we don’t actually need to be able to differentiate between quality scores at a very high resolution -- if the binning scheme is set up appropriately, it doesn’t make any difference to the variant discovery process downstream. This is not a new concept, but now the GATK engine has an argument to enable binning quality scores during the base recalibration (BQSR) process using a static binning scheme that we have determined produces optimal results in our hands. The level of compression is of course adjustable if you’d like to set your own tradeoff between compression and  base quality resolution. We have validated that this type of binning (with our chosen default parameters) does not have any noticeable adverse effect on germline variant discovery. However we are still looking into some possible effects on somatic variant discovery, so we can’t yet recommend binning for that application.</p>

<p><strong>Disable indel quality scores.</strong> The Base Recalibration process produces indel quality scores in addition to the regular base qualities. They are stored in the BI and BD tags of the read records, taking up a substantial amount of space in the resulting BAM files. There has been a lot of discussion about whether these indel quals are worth the file size inflation. Well, we’ve done a lot of testing and we’ve now decided that no, for most use cases the indel quals don’t make enough of a difference to justify the extra file size. The one exception to this is when processing PacBio data, it seems that indel quals may help model the indel-related errors of that technology. But for the rest, we’re now comfortable recommending the use of the <a rel="nofollow" href="https://www.broadinstitute.org/gatk/guide/tooldocs/org_broadinstitute_gatk_engine_CommandLineGATK.php#--disable_indel_quals"><code class="code codeInline" spellcheck="false">--disable_indel_quals</code></a> argument when writing out the recalibrated BAM file with PrintReads.</p>
